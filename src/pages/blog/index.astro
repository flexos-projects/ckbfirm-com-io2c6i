---
import { getCollection } from "astro:content";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Insights & Legal Updates | The CKB Firm</title>
  <style>
    body { font-family: 'Inter', sans-serif; background: #FBFBFB; color: #4A5568; margin: 0; }
    .container { max-width: 1280px; margin: 0 auto; padding: 4rem 2rem; }
    h1 { font-family: 'Playfair Display', serif; color: #1B365D; font-size: 3rem; margin-bottom: 2rem; }
    .grid { display: grid; gap: 2rem; grid-template-columns: repeat(1, 1fr); }
    @media (min-width: 768px) { .grid { grid-template-columns: repeat(2, 1fr); } }
    @media (min-width: 1024px) { .grid { grid-template-columns: repeat(3, 1fr); } }
    .card { background: white; border-top: 4px solid #1B365D; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); transition: transform 0.2s; display: flex; flex-direction: column; }
    .card:hover { transform: translateY(-4px); }
    .card-img { width: 100%; aspect-ratio: 16/9; object-fit: cover; background: linear-gradient(135deg, #1B365D 0%, #C5A059 100%); }
    .card-content { padding: 1.5rem; flex-grow: 1; }
    .date { font-size: 0.875rem; color: #C5A059; font-weight: 600; text-transform: uppercase; }
    .card-title { font-family: 'Playfair Display', serif; color: #1B365D; font-size: 1.5rem; margin: 0.5rem 0; }
    .excerpt { font-size: 1rem; line-height: 1.5; margin-bottom: 1.5rem; }
    .read-more { color: #1B365D; font-weight: 700; text-decoration: none; border-bottom: 2px solid #C5A059; transition: color 0.2s; }
    .read-more:hover { color: #C5A059; }
  </style>
</head>
<body>
  <main class="container">
    <h1>Insights from Our Experts</h1>
    <div class="grid">
      {posts.map(post => (
        <article class="card">
          <img src={post.data.image} alt={post.data.title} class="card-img" />
          <div class="card-content">
            <div class="date">{post.data.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
            <h2 class="card-title">{post.data.title}</h2>
            <p class="excerpt">{post.data.description.substring(0, 150)}...</p>
            <a href={`/blog/${post.id}`} class="read-more">Read more</a>
          </div>
        </article>
      ))}
    </div>
  </main>
</body>
</html>